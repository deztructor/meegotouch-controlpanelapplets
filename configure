#!/bin/sh

FILENAME=localconfig.pri

cat > ${FILENAME} << EOF
#
# This file has been generated by the configure script of the 
# meegotouch-controlpanelapplets package. The file will be automatically
# overwritten, please do not modify.
#
EOF

which pkg-config > /dev/null
if [ $? -eq 0 ]; then
    #
    # We have a heavy QmSystem dependency in the displayapplet and in the
    # batteryapplet. This is the most important closed source dependency of the
    # source
    #
    pkg-config --exists qmsystem
    if [ $? -eq 0 ]; then
        echo "DEFINES += HAVE_QMSYSTEM" >> ${FILENAME}
    fi

    #
    # The wallpaper applet uses the contentmaneger to implement the 'select from
    # my gallery' widget.
    #
    pkg-config --exists ContentManager
    if [ $? -eq 0 ]; then
        echo "DEFINES += HAVE_CONTENT_MANAGER" >> ${FILENAME}
    fi
    
    #
    # The aboutapplet has some CellularQt dependency.
    #
    pkg-config --exists CellularQt
    if [ $? -eq 0 ]; then
        echo "DEFINES += HAVE_CELLULAR_QT" >> ${FILENAME}
    fi

    #
    # The aboutapplet has some libsysinfo0 dependency.
    #
    pkg-config --exists sysinfo
    if [ $? -eq 0 ]; then
        echo "DEFINES += HAVE_SYSINFO" >> ${FILENAME}
    fi

fi
    
#
# We also have some dependency towards the profile Qt library in the profile
# applet.
#
if [ -e /usr/include/profile-qt/profile.h ]; then 
    echo "DEFINES += HAVE_PROFILE_QT" >> ${FILENAME}
fi 


#echo "# All values were removed for testing purposes..." > ${FILENAME}

echo Configured meegotouch-controlpanelapplets as follows:
echo =====================================================
cat ${FILENAME}
